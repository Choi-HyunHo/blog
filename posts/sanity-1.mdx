---
title: Sanity를 Next.js에서 start❗️
date: "2023-08-21"
description: 시작부터 schemas 를 만들자
tag: Dev
---

> sanity 초기 세팅은 문서를 보고 따라하면 되기 때문에 별도의 정리는 하지 않겠습니다.

sanity-studio 를 프로젝트 안에 세팅 할 수도 있고 외부에 세팅 할 수도 있는데 <br/> 저는 편의를 위해서 내부에 세팅 했습니다.

<img
    width="234"
    alt="image"
    src="https://github.com/Choi-HyunHo/blog/assets/87301268/2b084d66-ef82-4c4a-9b7b-a84efe0f85d8"
/>

`cd sanity-studio` 명령어를 사용해서 디렉토리에 접근하고 <br/> package.json 파일에 명시되어 있는 것처럼 `yarn dev`로 실행하면 됩니다.

### 초기 실행 화면

<img
    width="1347"
    alt="image"
    src="https://github.com/Choi-HyunHo/blog/assets/87301268/bda843c9-0546-4b3f-b046-1ac0cdb14cf0"
/>

<br />

## 스키마 정의하기

schemas 폴더 안에 사용할 모델들의 문서를 만들어줍니다.

간단하게 용어 정리만 하고 넘어가면

-   스키마(schemas) : 해당 문서에 어떤 종류의 값이 들어가는지(이름, 필드, 데이터 유형 등)
-   모델(model) : 데이터가 구성되고 저장되는 방식을 구조적으로 표현한 것

> 데이터베이스 공부의 필요성을 또 느낍니다,,🥹 얼른 해야지...

<br />

폴더 구조 중 `index.ts` 라는 파일이 있었는데 해당 파일안에는 초기에 아래와 같이 되어있습니다.

```js
export const schemaTypes = [];
```

<br />

### user 라는 스키마 만들기

index.ts와 같은 위치에 `user.ts` 라는 스키마를 정의 해보겠습니다.

```js showLineNumbers
// 모델 정의 - User라는 데이터 모델
export default {
    title: "User",
    name: "user",
    type: "document",
    fields: [
        {
            title: "Username", // studio UI 에서 보는 이름
            name: "username", // 실제 DB에서 접근할 때 사용하는 이름(key)
            type: "string",
        },
        {
            title: "Name",
            name: "name",
            type: "string",
        },
        {
            title: "Email",
            name: "email",
            type: "string",
        },
        {
            title: "Image",
            name: "image",
            type: "string",
        },
        {
            title: "Following",
            name: "following",
            type: "array",
            of: [
                {
                    type: "reference", // 참고
                    to: [{ type: "user" }], // user타입에 대한 스키마 참고
                },
            ],
            validation: (Rule: any) => Rule.unique(), // 중복x 유효성 검사
        },
    ],
};
```

-   해당 구조는 공식문서에 나와있습니다. 👉 [Create a schemas](https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio)
-   type : 'array' 는 어떤 배열의 타입인지 참고가 가능 합니다 👉 [array-type](https://www.sanity.io/docs/array-type#R7Awwxtw)
-   schema의 타입 정리 문서 👉 [schema-types](https://www.sanity.io/docs/schema-types)

<br />

위에서 정리된 모델을 처음에 봤던 `index.ts` 에 넣어줍니다.

```js
import user from "./user";

export const schemaTypes = [user];
```

<br />

### 스키마를 생성한 후 화면

<img
    width="1332"
    alt="image"
    src="https://github.com/Choi-HyunHo/blog/assets/87301268/84fcf5b2-d08d-449a-8891-6dc997252685"
/>

-   코드로 정의한 문서가 sanity-studio 에 적용되어 있는 것을 볼 수 있습니다.
-   해당 UI를 통해 데이터를 추가하고 다룰 수 있습니다.

<br />

## 여기까지 본 sanity 는

sanity는 Content Lake안에 있는 데이터베이스를 사용하는데 안에 데이터를 CRUD 할 때 호출하는 함수들이 <br/> CMS안에 내장 돼있어서
데이터베이스에 대한 깊은 지식 없이도 편하게 사용 할 수 있고 <br/> 코드를 전혀 모르는 사람도 sanity studio UI로 데이터를 조작 할 수 있습니다.(위에서 본 것 처럼!) <br/>

다음 포스팅은 sanity studio 에서 데이터를 생성하고 다뤄보도록 하겠습니다.
