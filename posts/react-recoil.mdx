---
title: recoilì€ redux ë³´ë‹¤ ê³¼ì—° ì¢‹ì„ê¹Œâ“
date: 2023-07-21
description: recoilì„ ì•Œì•„ë³´ì
tag: React
---

[React ìƒíƒœê´€ë¦¬ íˆìŠ¤í† ë¦¬](https://www.choi-hyunho.com/posts/React/react-state-manage) í¬ìŠ¤íŒ…ì„ ë¨¼ì € ì°¸ê³ í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤ ğŸ‘‹

í¬ìŠ¤íŒ…ì—ì„œ ì‚¬ìš©í•œ ì½”ë“œë“¤ì€ Repositories ì£¼ì†Œë¥¼ ê±¸ì–´ë†“ê² ìŠµë‹ˆë‹¤. ğŸ‘‰ [https://github.com/Choi-HyunHo/recoil-study](https://github.com/Choi-HyunHo/recoil-study)

## RecoilRoot

ì»´í¬ë„ŒíŠ¸ì—ì„œ Recoil ì˜ state ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” reduxë¥¼ ì‚¬ìš©í•˜ê¸°ì „ì— Provider ë¥¼ ì”Œìš°ë“¯ ë¶€ëª¨ì— `RecoilRoot`ë¥¼ ì„ ì–¸í•´ì•¼ í•©ë‹ˆë‹¤.

-   ìµœìƒìœ„ rootì— ì„ ì–¸ì„ í–ˆìŠµë‹ˆë‹¤.

```js
import Counter from "./Counter";
import NumberText from "./NumberText";

// recoil ê´€ë ¨ ì½”ë“œ import
import { RecoilRoot } from "recoil";

function App() {
    return (
        <RecoilRoot>
            <Counter />
            <NumberText />
        </RecoilRoot>
    );
}

export default App;
```

## Atoms

> AtomsëŠ” stateì˜ ë‹¨ìœ„ì´ë©° ì—…ë°ì´íŠ¸ì™€ êµ¬ë…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. <br/> atom ê°’ì„ ì½ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì€ ì•”ë¬µì ìœ¼ë¡œ atomì„ êµ¬ë…í•©ë‹ˆë‹¤.

-   atomì— ë³€í™”ê°€ ìƒê¸°ë©´ atomì„ êµ¬ë…í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ì´ ë©ë‹ˆë‹¤.

```js
import { atom } from "recoil";

export const counterValue = atom({
    key: "counterState", // ì „ì—­ì ìœ¼ë¡œ ìœ ì¼í•´ì•¼ í•¨
    default: 0, // ì´ˆê¸° ê°’
});
```

-   `key` : ë‚´ë¶€ì ìœ¼ë¡œ atomì„ ì‹ë³„ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê³ ìœ í•œ ë¬¸ìì—´
-   `default` : atomì˜ ì´ˆê¸°ê°’

ğŸ’¡ atomì„ ì„¤ì •í•  ë•Œ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” selectorsë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

## useRecoilState

Atoms ë° Selectorsì™€ ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•´ ìì£¼ ì‚¬ìš©ë˜ëŠ” hooksì…ë‹ˆë‹¤.

-   `useRecoilState()`: atomì„ ì½ê³ , ì“°ê¸° ìœ„í•´ ì‚¬ìš©

ë‹¤ìŒìœ¼ë¡œ ìœ„ì˜ counterValue ë¥¼ ì‚¬ìš©í•´ì„œ ì´ˆê¸°ê°’ì„ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœë³€í™”ë¥¼ ë°œìƒì‹œí‚¤ê² ìŠµë‹ˆë‹¤.

```js
import React from "react";
import { useRecoilState } from "recoil";
import { counterValue } from "./atom";

export default function Counter() {
    const [value, setValue] = useRecoilState(counterValue);

    const add = () => {
        setValue((prev) => prev + 1);
    };

    const minus = () => {
        setValue((prev) => prev - 1);
    };

    return (
        <div>
            <button onClick={() => add()}>+</button>
            <p>{value}</p>
            <button onClick={() => minus()}>-</button>
        </div>
    );
}
```

![](https://github.com/Choi-HyunHo/blog/assets/87301268/3ac850b4-3236-4df7-949b-84dc0490c6e4)

ì ê·¸ëŸ¼, ê°’ì„ ë³€ê²½í•˜ê³  `ë‹¤ìŒ ê°’ì€ ë¬´ì—‡ì…ë‹ˆë‹¤.` ë¼ê³  ì‚¬ìš©ìì—ê²Œ í‘œì‹œí•  ìˆ˜ ìˆì„ê¹Œìš”?

-   Selectorsì— ëŒ€í•´ ì‚´í´ë´…ì‹œë‹¤.

## Selectors

ìœ„ì—ì„œ ì ê¹ ë‚˜ì™”ë˜ selectorsë¥¼ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

> selectorëŠ” ì „ì—­ ìƒíƒœ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ ê³„ì‚°ì„ í†µí•´ íŒŒìƒëœ ìƒíƒœ(derived state)ë¥¼ ë°˜í™˜í•˜ëŠ” ìˆœìˆ˜í•¨ìˆ˜ì…ë‹ˆë‹¤.

-   `get` : í•¨ìˆ˜ë§Œ ì œê³µë˜ë©´ selectorëŠ” **ì½ê¸°ë§Œ ê°€ëŠ¥**í•œ RecoilValueReadOnly ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
-   `set` : í•¨ìˆ˜ ë˜í•œ ì œê³µë˜ë©° (optional) selectorëŠ” **ì“°ê¸° ê°€ëŠ¥**í•œ RecoilState ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

> selectorëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê°’ì„ ìì²´ì ìœ¼ë¡œ ìºì‹± í•©ë‹ˆë‹¤. <br/> ì…ë ¥ëœ ì  ìˆëŠ” ê°’ì„ ê¸°ì–µí•˜ê³ , ì´ ê°’ì´ ì¬í˜¸ì¶œë˜ë©´ ìºì‹±ëœ ê²°ê³¼ë¥¼ ë°”ë¡œ ë³´ì—¬ì£¼ê¸° ë•Œë¬¸ì— <br/> ë¹„ë™ê¸° ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ì¸¡ë©´ì—ì„œ ìœ ë¦¬ í•©ë‹ˆë‹¤.

```js
import { atom, selector } from "recoil";

export const counterValue = atom({
    key: "counterState",
    default: 0,
});

export const counterNextValue = selector({
    key: "counterNextState",
    get: ({ get }) => {
        return get(counterValue) + 1;
    },
});
```

### useRecoilValue

-   `useRecoilValue()`: atomì„ ì½ê¸°ë§Œ í•  ë•Œ ì‚¬ìš©

```js
import React from "react";
import { useRecoilValue } from "recoil";
import { counterNextValue } from "./atom";

export default function NumberText() {
    const nextCount = useRecoilValue(counterNextValue);
    return <p>ë‹¤ìŒ ì¹´ìš´í„°ëŠ” {nextCount} ì…ë‹ˆë‹¤.</p>;
}
```

![](https://github.com/Choi-HyunHo/blog/assets/87301268/4149a1ae-16a3-442d-a358-05915c0b7b2b)

ê·¸ ì™¸ì˜ ë‹¤ë¥¸ hooks

-   `useSetRecoilState()` : atomì„ ì“°ë ¤ê³ ë§Œ í•  ë•Œ ì‚¬ìš©.
-   `useResetRecoilState()` : atomì„ default ê°’ìœ¼ë¡œ ì´ˆê¸°í™” í•  ë•Œ ì‚¬ìš©.

## useResetRecoilState

```js
import React from "react";
import { useRecoilValue, useResetRecoilState } from "recoil";
import { counterNextValue, counterValue } from "./atom";

export default function NumberText() {
    const nextCount = useRecoilValue(counterNextValue);
    const resetCounter = useResetRecoilState(counterValue); // ìœ„ì˜ atom ì°¸ê³ 
    return (
        <>
            <p>ë‹¤ìŒ ì¹´ìš´í„°ëŠ” {nextCount} ì…ë‹ˆë‹¤.</p>
            <button onClick={resetCounter}>Reset</button>
        </>
    );
}
```

![](https://github.com/Choi-HyunHo/blog/assets/87301268/208f7440-06e8-445e-a019-1baf3b30bc29)

<br />

## Recoil ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ë²•

### 1. ê¸°ë³¸ì ì¸ async/await

selector ì— `async/await`ë¥¼ ì‚¬ìš©í•´ì„œ APIë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë¹„ë™í‚¤ ì½”ë“œ ì˜ˆì‹œ ì…ë‹ˆë‹¤.

-   APIëŠ” ëœë˜í•˜ê²Œ ì‚¬ì§„ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” OPEN API ë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.(https://dog.ceo/)

```js
import { atom, selector } from "recoil";

export const dogData = selector({
    key: "dogData",
    get: async () => {
        const res = await fetch("https://dog.ceo/api/breeds/image/random");
        const data = await res.json();
        return data.message;
    },
});
```

```js
import React from "react";
import { useRecoilValue } from "recoil";
import { dogData } from "./atom";

export default function Dog() {
    const dogImg = useRecoilValue(dogData);

    return (
        <div style={{ display: "flex", justifyContent: "center" }}>
            <img src={dogImg} alt="" width="20%" height="auto" />
        </div>
    );
}
```

<img
    width="730"
    alt="image"
    src="https://github.com/Choi-HyunHo/blog/assets/87301268/a2f23d04-6e23-4f7f-8b59-df748b1d7126"
/>

<br />

### 2. selectorFamily()

`selectorFamily` ëŠ” ë§¤ê°œë³€ìˆ˜ë¥¼ ì´ìš©í•´ ë¹„ë™ê¸° í˜¸ì¶œì„ í•  ë•Œ ì‚¬ìš© í•©ë‹ˆë‹¤.

```js
import { selectorFamily } from "recoil";

export const nameBreed = selectorFamily({
    key: "breed",
    get: (breed) => async () => {
        const res = await fetch(
            `https://dog.ceo/api/breed/${breed}/images/random`
        );
        const data = await res.json();
        return data.message;
    },
});
```

```js
import Counter from "./Counter";

// recoil ê´€ë ¨ ì½”ë“œ import
import { RecoilRoot } from "recoil";
import NumberText from "./NumberText";
import Dog from "./Dog";

function App() {
    return (
        <RecoilRoot>
            <Counter />
            <NumberText />
            <Dog breed="pug" />
        </RecoilRoot>
    );
}

export default App;
```

```js
import React from "react";
import { useRecoilValue } from "recoil";
import { dogData, nameBreed } from "./atom";

export default function Dog({ breed }) {
    // const dogImg = useRecoilValue(dogData);
    const dogImg = useRecoilValue(nameBreed(breed));

    return (
        <div style={{ display: "flex", justifyContent: "center" }}>
            <img src={dogImg} alt="" width="20%" height="auto" />
        </div>
    );
}
```

<img
    width="560"
    alt="image"
    src="https://github.com/Choi-HyunHo/blog/assets/87301268/2523c6d2-f64f-41b6-83e8-014f1d881212"
/>

<br />

## ì •ë¦¬

recoil ì„ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë´¤ìŠµë‹ˆë‹¤.<br/> ì´ë²ˆ í¬ìŠ¤íŒ… ë§ê³ ë„ ê¸°ëŠ¥ì´ ë” ë§ê¸°ë•Œë¬¸ì— recoilì„ ì²˜ìŒ ì‚¬ìš©í•˜ê²Œ ëœë‹¤ë©´ ì°¸ê³ í•˜ë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤ğŸ‘

ë§ˆì§€ë§‰ìœ¼ë¡œ ëŒ€ì¤‘ì ì¸ redux ì™€ ì§§ê²Œë‚˜ë§ˆ ë¹„êµë¥¼ í•´ë³´ìë©´

ì¥ì 

-   ì„¸íŒ…ì´ ê°„ë‹¨í•©ë‹ˆë‹¤.
-   ë¹„ë™ê¸° ìš”ì²­ì´ ì§ê´€ì  ì…ë‹ˆë‹¤.

ë‹¨ì 

-   ì•ˆì •ì„±(ì§€ì†ì ì¸ ì—…ë°ì´íŠ¸ ì—¬ë¶€ í™•ì¸ í•„ìš”)
-   ê°œë°œì ë„êµ¬ì˜ ë¶€ì¬
-   ë¶€ì¡±í•œ ë ˆí¼ëŸ°ìŠ¤(reduxê°€ ë„ˆë¬´ ì•ë„ì ìœ¼ë¡œ ìë£Œê°€ ë§ìŠµë‹ˆë‹¤..)

<br />

## ì°¸ê³ 

-   [https://recoiljs.org/ko/](https://recoiljs.org/ko/)
